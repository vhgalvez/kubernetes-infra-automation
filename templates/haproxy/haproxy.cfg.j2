global
    log /dev/log local0
    log /dev/log local1 notice
    chroot /var/lib/haproxy
    stats socket /run/haproxy/admin.sock mode 660 level admin
    stats timeout 30s
    user haproxy
    group haproxy
    daemon
    maxconn 50000

defaults
    log global
    mode http
    option httplog
    timeout connect 5s
    timeout client 50s
    timeout server 50s
    retries 3

frontend kubernetes_api
    bind *:6443
    default_backend kube_masters

backend kube_masters
    balance roundrobin
    option httpchk GET /healthz
    http-check expect status 200
    server master1 10.17.4.21:6443 check inter 2s fall 3 rise 2
    server master2 10.17.4.22:6443 check inter 2s fall 3 rise 2
    server master3 10.17.4.23:6443 check inter 2s fall 3 rise 2

    
# IMPORTANTE: Asegurar salto de l√≠nea al final

